# PWA Setup –¥–ª—è TOQIBOX

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PWA

### 1. Manifest —Ñ–∞–π–ª (`/public/site.webmanifest`)
- ‚úÖ `name`, `short_name` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ `start_url` = `/` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ `scope` = `/` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ `display` = `standalone` - –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ `background_color`, `theme_color` = `#07080b` (—Ç–µ–º–Ω–∞—è —Ç–µ–º–∞) - –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ –ò–∫–æ–Ω–∫–∏ 192x192 –∏ 512x512 (any + maskable) - –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ `description` - –¥–æ–±–∞–≤–ª–µ–Ω

### 2. HTML —Ç–µ–≥–∏ (`index.html`)
- ‚úÖ `<link rel="manifest" href="/site.webmanifest">` - –¥–æ–±–∞–≤–ª–µ–Ω
- ‚úÖ `<meta name="theme-color" content="#07080b">` - –¥–æ–±–∞–≤–ª–µ–Ω
- ‚úÖ `<link rel="apple-touch-icon" href="/apple-touch-icon.png">` - –¥–æ–±–∞–≤–ª–µ–Ω
- ‚úÖ Favicons (svg + ico) - –¥–æ–±–∞–≤–ª–µ–Ω—ã
- ‚úÖ iOS PWA –º–µ—Ç–∞-—Ç–µ–≥–∏:
  - `apple-mobile-web-app-capable` = `yes`
  - `apple-mobile-web-app-status-bar-style` = `black-translucent`
  - `apple-mobile-web-app-title` = `TOQIBOX`

### 3. Service Worker (vite-plugin-pwa)
- ‚úÖ –ü–ª–∞–≥–∏–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ `registerType: "autoUpdate"` - –≤–∫–ª—é—á–µ–Ω
- ‚úÖ Precache: HTML, JS, CSS, –∏–∫–æ–Ω–∫–∏, manifest
- ‚úÖ Runtime caching:
  - `https://cdn.toqibox.win/**` - CacheFirst (30 –¥–Ω–µ–π)
  - Supabase API - NetworkFirst (5 –º–∏–Ω—É—Ç)
  - TOQIBOX API - NetworkFirst (5 –º–∏–Ω—É—Ç)
- ‚úÖ Fallback: `/index.html` –¥–ª—è –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–∞

### 4. –ò–∫–æ–Ω–∫–∏
–í—Å–µ –∏–∫–æ–Ω–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `/public`:
- ‚úÖ `favicon.ico`
- ‚úÖ `favicon.svg`
- ‚úÖ `apple-touch-icon.png`
- ‚úÖ `web-app-manifest-192x192.png`
- ‚úÖ `web-app-manifest-512x512.png`

## üöÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (build/preview)
```bash
npm run build
npm run preview
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
1. **Chrome/Edge (Desktop)**
   - –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Application ‚Üí Manifest
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ manifest –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Application ‚Üí Service Workers - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–∫—Ç–∏–≤–µ–Ω
   - –í –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –∫–Ω–æ–ø–∫–∞ "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å"

2. **Android Chrome**
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç
   - –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω"
   - –ò–ª–∏ —á–µ—Ä–µ–∑ –º–µ–Ω—é ‚Üí "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"

3. **iOS Safari**
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç
   - –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" ‚Üí "–ù–∞ —ç–∫—Ä–∞–Ω ¬´–î–æ–º–æ–π¬ª"
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏–∫–æ–Ω–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ standalone —Ä–µ–∂–∏–º–µ

### Lighthouse PWA Audit
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Lighthouse
2. –í—ã–±–µ—Ä–∏—Ç–µ "Progressive Web App"
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É
4. –î–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏ –±–∞–∑–æ–≤—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏:
   - ‚úÖ Manifest –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
   - ‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
   - ‚úÖ HTTPS (–Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)
   - ‚úÖ –ò–∫–æ–Ω–∫–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
   - ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í DevTools ‚Üí Network ‚Üí –≤–∫–ª—é—á–∏—Ç–µ "Offline"
3. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
4. –î–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è —Ö–æ—Ç—è –±—ã –±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (App Shell)
5. –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–µ–ª–æ–≥–æ —ç–∫—Ä–∞–Ω–∞

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è R2** (cdn.toqibox.win): CacheFirst, 30 –¥–Ω–µ–π
- **API –∑–∞–ø—Ä–æ—Å—ã** (Supabase, toqibox.win/api): NetworkFirst, 5 –º–∏–Ω—É—Ç
- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã**: Precache –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

### –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
Service Worker –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –Ω–æ–≤–æ–º –¥–µ–ø–ª–æ–µ –±–ª–∞–≥–æ–¥–∞—Ä—è `registerType: "autoUpdate"`.

### Dev —Ä–µ–∂–∏–º
–í dev —Ä–µ–∂–∏–º–µ PWA –ø–ª–∞–≥–∏–Ω –æ—Ç–∫–ª—é—á–µ–Ω (`devOptions.enabled: false`) –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å HMR.

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### SW –Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–±–æ—Ä–∫–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ (`npm run build`)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–∞–π—Ç –æ—Ç–∫—Ä—ã—Ç –ø–æ HTTPS (–∏–ª–∏ localhost)

### –ò–∫–æ–Ω–∫–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç–∏ –≤ `site.webmanifest` (–¥–æ–ª–∂–Ω—ã –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `/`)
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ `/public`
- –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞

### –û—Ñ—Ñ–ª–∞–π–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ SW –∞–∫—Ç–∏–≤–µ–Ω –≤ DevTools ‚Üí Application ‚Üí Service Workers
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–µ—à –≤ Application ‚Üí Cache Storage
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `navigateFallback` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- [MDN: Progressive Web Apps](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)
- [vite-plugin-pwa –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://vite-pwa-org.netlify.app/)
- [Web.dev: PWA Checklist](https://web.dev/pwa-checklist/)

